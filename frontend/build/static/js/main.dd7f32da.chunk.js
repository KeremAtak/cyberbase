(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{15:function(e,t,a){},29:function(e,t,a){e.exports=a(62)},35:function(e,t,a){},62:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(26),o=a.n(s),c=(a(35),a(6)),l=a(7),i=a(10),u=a(8),m=a(11),h=(a(15),a(3)),p=a.n(h),g=a(12),d=a(13),f=a.n(d),v="http://localhost:3001/api/messages",b=null,w={getAll:function(){return f.a.get(v).then(function(e){return e.data})},create:function(){var e=Object(g.a)(p.a.mark(function e(t){var a,n;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:b}},e.next=3,f.a.post(v,t,a);case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),setToken:function(e){b="bearer ".concat(e)},remove:function(e){return f.a.delete(v+"/"+e).then(function(e){return e.data})}},E=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(i.a)(this,Object(u.a)(t).call(this))).logOut=function(t){t.preventDefault();try{window.localStorage.removeItem("loggedUser"),e.setState({user:null})}catch(a){alert(a)}},e.handleChange=function(t){e.setState({newMessage:t.target.value})},e.addNewMessage=function(){var t=Object(g.a)(p.a.mark(function t(a){var n;return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:a.preventDefault(),n={content:e.state.newMessage,date:new Date,user:e.state.user},w.create(n).then(function(t){e.setState({messages:e.state.messages.concat(t),newMessage:""})});case 3:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),e.helloUser=function(){return r.a.createElement("div",null,e.userIsLoggedIn()?r.a.createElement("h3",null,"Good day, ",e.state.user.username," "):"Hello visitor")},e.addNewMessageForm=function(){return r.a.createElement("div",null,e.userIsLoggedIn()?r.a.createElement("div",null,r.a.createElement("div",{class:"form-group"},r.a.createElement("input",{value:e.state.newMessage,onChange:e.handleChange,class:"form-control",type:"text",name:"message",placeholder:"..."})),r.a.createElement("div",{class:"form-group"},r.a.createElement("button",{class:"btn btn-primary btn-block",type:"submit",onClick:e.addNewMessage},"Add new message"))):"You may add your own comments once you log in")},e.viewLoginButtons=function(){return r.a.createElement("div",null,e.userIsLoggedIn()?r.a.createElement("button",{className:"btn2 btn-6 btn-6a",onClick:e.logOut},"Log out"):r.a.createElement("div",null,r.a.createElement("a",{className:"btn2 btn-6 btn-6a",href:"/login"},"Log in"),r.a.createElement("a",{className:"btn2 btn-6 btn-6a",href:"/register"},"Register")))},e.viewAdmin=function(){return r.a.createElement("div",null,e.userIsAdmin()?r.a.createElement("a",{className:"btn2 btn-6 btn-6a",href:"/admin"},"Admin tools"):"")},e.userIsLoggedIn=function(){return null!==e.state.user},e.userIsAdmin=function(){return null!==e.state.user&&"Matti"===e.state.user.username},e.viewMessages=function(){for(var t=[],a=e.state.messages,n=0;n<a.length;n++)t.push(r.a.createElement("li",null,a[n].content," (",a[n].user.username,")"));return t},e.state={messages:[],newMessage:"",user:null},e}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){var e=this;w.getAll().then(function(t){e.setState({messages:t})});var t=window.localStorage.getItem("loggedUser");if(t){var a=JSON.parse(t);console.log(a),this.setState({user:a}),w.setToken(a.token)}}},{key:"render",value:function(){return console.log(this.state.newMessage),r.a.createElement("div",{class:"login-dark"},r.a.createElement("form",null,r.a.createElement("h1",{class:"sr-only"},"Insecure cyberbase app"),r.a.createElement("div",null,this.helloUser()),r.a.createElement("div",{class:"illustration"},r.a.createElement("i",{class:"icon ion-ios-locked-outline"})),r.a.createElement("ul",null,this.viewMessages()),this.addNewMessageForm(),this.viewLoginButtons()))}}]),t}(r.a.Component),k=a(16),y={login:function(){var e=Object(g.a)(p.a.mark(function e(t){var a;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.post("http://localhost:3001/api/login",t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),register:function(){var e=Object(g.a)(p.a.mark(function e(t){var a;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.post("http://localhost:3001/api/users",t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},O=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(i.a)(this,Object(u.a)(t).call(this))).login=function(){var t=Object(g.a)(p.a.mark(function t(a){var n;return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),t.prev=1,t.next=4,y.login({username:e.state.username,password:e.state.password});case 4:n=t.sent,window.localStorage.setItem("loggedUser",JSON.stringify(n)),window.location.replace("http://localhost:3000"),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),console.log(t.t0);case 12:case"end":return t.stop()}},t,this,[[1,9]])}));return function(e){return t.apply(this,arguments)}}(),e.handleChange=function(t){e.setState(Object(k.a)({},t.target.name,t.target.value))},e.state={username:"",password:""},e}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return console.log(this.state.username+" "+this.state.password),r.a.createElement("div",{class:"login-dark"},r.a.createElement("form",{method:"post"},r.a.createElement("h1",{class:"sr-only"},"Insecure cyberbase app"),r.a.createElement("h2",{class:"sr-only"},"Login"),r.a.createElement("div",{class:"illustration"},r.a.createElement("i",{class:"icon ion-ios-locked-outline"})),r.a.createElement("div",{class:"form-group"},r.a.createElement("input",{value:this.state.username,onChange:this.handleChange,class:"form-control",type:"username",name:"username",placeholder:"Username"})),r.a.createElement("div",{class:"form-group"},r.a.createElement("input",{value:this.state.password,onChange:this.handleChange,class:"form-control",type:"password",name:"password",placeholder:"Password"})),r.a.createElement("div",{class:"form-group"},r.a.createElement("button",{class:"btn btn-primary btn-block",type:"submit",onClick:this.login},"Log In")),r.a.createElement("a",{href:"/register"},"No account? Click here to register."),r.a.createElement("br",null),r.a.createElement("a",{href:"/"},"Back to main page")))}}]),t}(r.a.Component),j=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(i.a)(this,Object(u.a)(t).call(this))).register=function(){var t=Object(g.a)(p.a.mark(function t(a){return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),t.prev=1,t.next=4,y.register({username:e.state.username,password:e.state.password});case 4:t.sent,e.setState({username:"",password:""}),window.location.replace("http://localhost:3000/login"),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),alert(t.t0);case 12:case"end":return t.stop()}},t,this,[[1,9]])}));return function(e){return t.apply(this,arguments)}}(),e.handleChange=function(t){e.setState(Object(k.a)({},t.target.name,t.target.value))},e.state={username:"",password:""},e}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return console.log(this.state.username+" "+this.state.password),r.a.createElement("div",{class:"login-dark"},r.a.createElement("form",{method:"post"},r.a.createElement("h1",{class:"sr-only"},"Insecure cyberbase app"),r.a.createElement("h2",{class:"sr-only"},"Registration"),r.a.createElement("div",{class:"illustration"},r.a.createElement("i",{class:"icon ion-ios-locked-outline"})),r.a.createElement("div",{class:"form-group"},r.a.createElement("input",{value:this.state.username,onChange:this.handleChange,class:"form-control",type:"username",name:"username",placeholder:"Username"})),r.a.createElement("div",{class:"form-group"},r.a.createElement("input",{value:this.state.password,onChange:this.handleChange,class:"form-control",type:"password",name:"password",placeholder:"Password"})),r.a.createElement("div",{class:"form-group"},r.a.createElement("button",{class:"btn btn-primary btn-block",type:"submit",onClick:this.register},"Register")),r.a.createElement("a",{href:"/login"},"Already registered? Click here to login."),r.a.createElement("br",null),r.a.createElement("a",{href:"/"},"Back to main page")))}}]),t}(r.a.Component),C=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(i.a)(this,Object(u.a)(t).call(this))).viewMessages=function(){for(var t=[],a=e.state.messages,n=function(n){t.push(r.a.createElement("li",null,a[n].content," (",a[n].user.username,")",r.a.createElement("button",{type:"submit",onClick:function(){return e.deleteMessage(a[n].id)}},"Delete")))},s=0;s<a.length;s++)n(s);return t},e.deleteMessage=function(e){w.remove(e)},e.state={messages:[]},e}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){var e=this;w.getAll().then(function(t){e.setState({messages:t})})}},{key:"render",value:function(){return r.a.createElement("div",{class:"login-dark"},r.a.createElement("form",null,r.a.createElement("h1",{class:"sr-only"},"Insecure cyberbase app"),r.a.createElement("h2",{class:"sr-only"},"Admin tools"),r.a.createElement("div",{class:"illustration"},r.a.createElement("i",{class:"icon ion-ios-locked-outline"})),r.a.createElement("ul",null,this.viewMessages()),r.a.createElement("a",{href:"/"},"Back to main page")))}}]),t}(r.a.Component),I=a(27),M=a(65),S=a(63),x=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(i.a)(this,Object(u.a)(t).call(this))).userIsAdmin=function(){return null!==e.state.user&&"Matti"===e.state.user.username},e.state={user:null},e}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){var e=window.localStorage.getItem("loggedUser");if(e){var t=JSON.parse(e);console.log(t),this.setState({user:t})}}},{key:"render",value:function(){var e=this,t=this.props,a=t.component,n=Object(I.a)(t,["component"]);return r.a.createElement(M.a,Object.assign({},n,{render:function(t){return e.userIsAdmin()?r.a.createElement(a,t):r.a.createElement(S.a,{to:"/"})}}))}}]),t}(r.a.Component),A=a(64),N=a(66),L=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(i.a)(this,Object(u.a)(t).call(this))).state={messages:[],newMessage:"",user:null},e}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){var e=window.localStorage.getItem("loggedUser");if(e){var t=JSON.parse(e);console.log(t.access),this.setState({user:t}),w.setToken(t.token)}}},{key:"render",value:function(){return r.a.createElement(A.a,null,r.a.createElement(N.a,null,r.a.createElement(M.a,{exact:!0,path:"/",component:E}),r.a.createElement(M.a,{exact:!0,path:"/login",component:O}),r.a.createElement(M.a,{exact:!0,path:"/register",component:j}),r.a.createElement(x,{path:"/admin",component:C})))}}]),t}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(L,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[29,2,1]]]);
//# sourceMappingURL=main.dd7f32da.chunk.js.map